---
import CardOverview from "../components/CardOverview.astro";
import OverviewLayout from "../components/layouts/OverviewLayout.astro";
import FlowerAnimation from "../components/FlowerAnimation.astro";
import Buttons from "../components/Buttons.astro";
import "../styles/overview.css";
import "../styles/style.css";

const data = await fetch("https://iquwaksrvuailrbwzeqm.supabase.co/rest/v1/paintings", {
  method: "GET",
  headers: {
    apikey:
      "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlxdXdha3NydnVhaWxyYnd6ZXFtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTU2MDgyNzEsImV4cCI6MjAzMTE4NDI3MX0.TAN2h-nqq62fwRfrJesymEvsWNpJv_HsJnaiA0kzups",
  },
}).then((res) => res.json());
---

<OverviewLayout title="Webshop">
  <div class="start-text1">
    <h1>WEBSHOP</h1>
    <div class="flower_1"><FlowerAnimation variant="primary" /></div>
  </div>
  <div class="start-text2">
    <p>
      Velkommen til min webshop! Træd ind i en verden af unikke <br /> kunstværker, skabt med kærlighed og passion. Udforsk en samling <br /> af malerier,
      der fanger øjet og berører sjælen. Hvert stykke er en <br />
      fortælling, en rejse, og en unik skat at tage med hjem.
    </p>
  </div>

  <div>
    <Buttons category="Alle" />
    <Buttons category="Lærred" />
    <Buttons category="Plakat" />
    <Buttons category="Tryk" />
    <Buttons category="Bog" />
  </div>

  <section class="cards_list">
    {
      data.map((data) => {
        return <CardOverview data={data} />;
      })
    }
  </section>
</OverviewLayout>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const buttons = document.querySelectorAll("button");
    buttons.forEach((button) => button.addEventListener("click", (e) => filtrer(e)));

    function filtrer(e) {
      // Hide all cards
      console.log(document.querySelectorAll(".card"));
      document.querySelectorAll(".card").forEach((element) => element.classList.add("hide"));
      console.log("Button clicked:", e.target.textContent);

      const filter = e.target.textContent.trim().toLowerCase();
      console.log("Cleaned filter", filter);
      switch (filter) {
        case "lærred":
          console.log("Filtering for Lærred");
          document.querySelectorAll(".lærred").forEach((element) => element.classList.remove("hide"));
          break;
        case "plakat":
          console.log("Filtering for Plakat");
          document.querySelectorAll(".plakat").forEach((element) => element.classList.remove("hide"));
          break;
        case "tryk":
          console.log("Filtering for Tryk");
          document.querySelectorAll(".tryk").forEach((element) => element.classList.remove("hide"));
          break;
        case "bog":
          console.log("Filtering for Bog");
          document.querySelectorAll(".bog").forEach((element) => element.classList.remove("hide"));
          break;
        default:
          console.log("Filtering for all");
          document.querySelectorAll(".card").forEach((element) => element.classList.remove("hide"));
          break;
      }
    }
  });
</script>

<style>
  /* GENERAL */

  .hide {
    display: none;
  }
  .cards_list {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    margin: 40px;
    gap: 60px;
  }

  .start-text1 {
    margin-left: 30px;
    margin-top: 20px;
  }

  .start-text1 {
    display: flex;
    gap: 15px;
  }

  .start-text1 img {
    width: 38px;
    height: 38px;
  }

  .start-text2 p {
    text-align: left;
    font-family: "Lato";
    font-weight: 600;
    font-size: 15px;
  }

  .start-text2 {
    margin-left: 40px;
    margin-bottom: 20px;
    margin-top: 5px;
  }

  .flower_1 {
    left: 350px;
  }

  .flower_1 {
    position: absolute;
  }

  /* KNAPPER */

  .show_more button {
    border: 0;
    background-color: #dadada;
    font-family: "Lato";
    font-size: 15px;
    color: #494242;
    padding: 10px;
    width: 120px;
    border-radius: 10px;
    margin-left: 35px;
  }

  .show_more {
    display: flex;
    justify-content: center;
    margin-top: 40px;
    margin-bottom: 40px;
  }

  .show_more button {
    background-color: #dadada;
    font-family: "Lato";
  }

  .show_more button:hover {
    box-shadow: 0 3px 6px 0 rgba(0, 0, 0, 0.2);
    background-color: #b0b0b0;
    cursor: pointer;
  }

  /* MEDIA QUERIES */
  @media only screen and (max-width: 600px) {
    .cards_list {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 40px;
    }

    .category2,
    .category3 {
      display: none;
    }

    .start-text1,
    .start-text2 {
      max-width: 350px;
    }

    .start-text2 p {
      font-weight: 400;
      font-size: 16px;
    }

    .show_more button {
      margin-left: 0;
      margin-top: 20px;
      font-size: 16px;
    }
    br {
      display: none;
    }
  }

  /* DARK MODE */
  body.dark {
    background-color: #494242;
  }

  body.dark p,
  body.dark h1,
  body.dark .kurv {
    color: #fcfff6;
  }
</style>
